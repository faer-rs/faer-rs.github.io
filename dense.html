<!DOCTYPE HTML>
<html lang="en" class="light sidebar-visible" dir="ltr">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>dense linear algebra</title>


        <!-- Custom HTML head -->

        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff">

        <link rel="icon" href="favicon.svg">
        <link rel="shortcut icon" href="favicon.png">
        <link rel="stylesheet" href="css/variables.css">
        <link rel="stylesheet" href="css/general.css">
        <link rel="stylesheet" href="css/chrome.css">
        <link rel="stylesheet" href="css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="highlight.css">
        <link rel="stylesheet" href="tomorrow-night.css">
        <link rel="stylesheet" href="ayu-highlight.css">

        <!-- Custom theme stylesheets -->

        <!-- MathJax -->
        <script async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

        <!-- Provide site root to javascript -->
        <script>
            var path_to_root = "";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>
        <!-- Start loading toc.js asap -->
        <script src="toc.js"></script>
    </head>
    <body>
    <div id="body-container">
        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            const html = document.documentElement;
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add("js");
        </script>

        <input type="checkbox" id="sidebar-toggle-anchor" class="hidden">

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            var sidebar = null;
            var sidebar_toggle = document.getElementById("sidebar-toggle-anchor");
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            } else {
                sidebar = 'hidden';
            }
            sidebar_toggle.checked = sidebar === 'visible';
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <!-- populated by js -->
            <mdbook-sidebar-scrollbox class="sidebar-scrollbox"></mdbook-sidebar-scrollbox>
            <noscript>
                <iframe class="sidebar-iframe-outer" src="toc.html"></iframe>
            </noscript>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle">
                <div class="sidebar-resize-indicator"></div>
            </div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky">
                    <div class="left-buttons">
                        <label id="sidebar-toggle" class="icon-button" for="sidebar-toggle-anchor" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </label>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title"></h1>

                    <div class="right-buttons">
                        <a href="print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>
                        <a href="https://github.com/sarah-quinones/faer-rs" title="Git repository" aria-label="Git repository">
                            <i id="git-repository-button" class="fa fa-github"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="matrix-management"><a class="header" href="#matrix-management">Matrix management</a></h1>
<h2 id="creating-a-matrix"><a class="header" href="#creating-a-matrix">Creating a matrix</a></h2>
<p><em><code>faer</code></em> provides several ways to create dense matrices and matrix views.</p>
<p>The main matrix types are <a href="https://docs.rs/faer/latest/faer/mat/struct.Mat.html"><code>Mat</code></a>, <a href="https://docs.rs/faer/latest/faer/mat/struct.MatRef.html"><code>MatRef</code></a> and <a href="https://docs.rs/faer/latest/faer/mat/struct.MatMut.html"><code>MatMut</code></a>,
which can be thought of as being analogous to <code>Vec</code>, <code>&amp;[_]</code> and <code>&amp;mut [_]</code>.</p>
<ul>
<li><a href="https://docs.rs/faer/latest/faer/mat/struct.Mat.html"><code>Mat</code></a> owns its data, provides read-write access to it, and can be resized after creation.</li>
<li><a href="https://docs.rs/faer/latest/faer/mat/struct.MatRef.html"><code>MatRef</code></a> provides read-only access to the underlying data.</li>
<li><a href="https://docs.rs/faer/latest/faer/mat/struct.MatMut.html"><code>MatMut</code></a> provides read-write access to the underlying data.</li>
</ul>
<p>The most flexible way to initialize a matrix is to initialize a zero matrix,
then fill out the values by hand.</p>
<pre><code class="language-rust">use faer::Mat;

let mut a = Mat::&lt;f64&gt;::zeros(4, 3);

for j in 0..a.ncols() {
    for i in 0..a.nrows() {
        a[(i, j)] = 9.0;
    }
}</code></pre>
<p>Given a callable object that outputs the matrix elements, <a href="https://docs.rs/faer/latest/faer/mat/struct.Mat.html#method.from_fn"><code>Mat::from_fn</code></a>, can also be used.</p>
<pre><code class="language-rust">use faer::Mat;

let a = Mat::from_fn(3, 4, |i, j| (i + j) as f64);</code></pre>
<p>For common matrices such as the zero matrix and the identity matrix, shorthands
are provided.</p>
<pre><code class="language-rust">use faer::Mat;

// creates a 10×4 matrix whose values are all `0.0`.
let a = Mat::&lt;f64&gt;::zeros(10, 4);

// creates a 5×4 matrix containing `0.0` except on the main diagonal,
// which contains `1.0` instead.
let a = Mat::&lt;f64&gt;::identity(5, 4);</code></pre>
<p>In some cases, users may wish to avoid the cost of initializing the matrix to zero,
in which case, unsafe code may be used to allocate an uninitialized matrix, which
can then be filled out before it's used.</p>
<pre><code class="language-rust">// `a` is initially a 0×0 matrix.
let mut a = Mat::&lt;f64&gt;::with_capacity(4, 3);

// `a` is now a 4×3 matrix, whose values are uninitialized.
unsafe { a.set_dims(4, 3) };

for j in 0..a.ncols() {
    for i in 0..a.nrows() {
        // we cannot write `a[(i, j)] = 9.0`, as that would
        // create a reference to uninitialized data,
        // which is currently disallowed by Rust.
        a.write(i, j, 9.0);

        // we can also skip the bound checks using
        // read_unchecked and write_unchecked
        unsafe { a.write_unchecked(i, j, 9.0) };
    }
}</code></pre>
<h2 id="creating-a-matrix-view"><a class="header" href="#creating-a-matrix-view">Creating a matrix view</a></h2>
<p>In some situations, it may be desirable to create a matrix view over existing
data.
In that case, we can use <a href="https://docs.rs/faer/latest/faer/mat/struct.MatRef.html"><code>MatRef</code></a> (or <a href="https://docs.rs/faer/latest/faer/mat/struct.MatMut.html"><code>MatMut</code></a> for
mutable views).</p>
<p>They can be created in a safe way using:</p>
<ul>
<li><a href="https://docs.rs/faer/latest/faer/mat/fn.from_column_major_slice.html"><code>mat::from_column_major_slice</code></a>,</li>
<li><a href="https://docs.rs/faer/latest/faer/mat/fn.from_row_major_slice.html"><code>mat::from_row_major_slice</code></a>,</li>
<li><a href="https://docs.rs/faer/latest/faer/mat/fn.from_column_major_slice_mut.html"><code>mat::from_column_major_slice_mut</code></a>,</li>
<li><a href="https://docs.rs/faer/latest/faer/mat/fn.from_row_major_slice_mut.html"><code>mat::from_row_major_slice_mut</code></a>,</li>
</ul>
<p>for contiguous matrix storage, or:</p>
<ul>
<li><a href="https://docs.rs/faer/latest/faer/mat/fn.from_column_major_slice_with_stride.html"><code>mat::from_column_major_slice_with_stride</code></a>,</li>
<li><a href="https://docs.rs/faer/latest/faer/mat/fn.from_row_major_slice_with_stride.html"><code>mat::from_row_major_slice_with_stride</code></a>,</li>
<li><a href="https://docs.rs/faer/latest/faer/mat/fn.from_column_major_slice_with_stride_mut.html"><code>mat::from_column_major_slice_with_stride_mut</code></a>,</li>
<li><a href="https://docs.rs/faer/latest/faer/mat/fn.from_row_major_slice_with_stride_mut.html"><code>mat::from_row_major_slice_with_stride_mut</code></a>,</li>
</ul>
<p>for strided matrix storage.</p>
<p>An unsafe lower level pointer API is also provided for handling uninitialized data
or arbitrary strides using <a href="https://docs.rs/faer/latest/faer/mat/fn.from_raw_parts.html"><code>mat::from_raw_parts</code></a> and <a href="https://docs.rs/faer/latest/faer/mat/fn.from_raw_parts_mut.html"><code>mat::from_raw_parts_mut</code></a>.</p>
<h2 id="converting-to-a-view"><a class="header" href="#converting-to-a-view">Converting to a view</a></h2>
<p>A <a href="https://docs.rs/faer/latest/faer/mat/struct.Mat.html"><code>Mat</code></a> instance <code>m</code> can be converted to <a href="https://docs.rs/faer/latest/faer/mat/struct.MatRef.html"><code>MatRef</code></a> or <a href="https://docs.rs/faer/latest/faer/mat/struct.MatMut.html"><code>MatMut</code></a> by writing <a href="https://docs.rs/faer/latest/faer/type.Mat.html#method.as_ref"><code>m.as_ref()</code></a>
or <a href="https://docs.rs/faer/latest/faer/type.Mat.html#method.as_mut"><code>m.as_mut()</code></a>.</p>
<h2 id="reborrowing-a-mutable-view"><a class="header" href="#reborrowing-a-mutable-view">Reborrowing a mutable view</a></h2>
<p>Immutable matrix views can be freely copied around, since they are non-owning
wrappers around a pointer and the matrix dimensions/strides.</p>
<p>Mutable matrices however are limited by Rust's borrow checker. Copying them
would be unsound since only a single active mutable view is allowed at a time.</p>
<p>This means the following code does not compile.</p>
<pre><code class="language-rust">use faer::{Mat, MatMut};

fn takes_view_mut(m: MatMut&lt;f64&gt;) {}

let mut a = Mat::&lt;f64&gt;::new();
let view = a.as_mut();

takes_view_mut(view);

// This would have failed to compile since `MatMut` is never `Copy`
// takes_view_mut(view);</code></pre>
<p>The alternative is to temporarily give up ownership over the data, by creating
a view with a shorter lifetime, then recovering the ownership when the view is
no longer being used.</p>
<p>This is also called reborrowing.</p>
<pre><code class="language-rust">use faer::{Mat, MatMut, MatRef};
use reborrow::*;

fn takes_view(m: MatRef&lt;f64&gt;) {}
fn takes_view_mut(m: MatMut&lt;f64&gt;) {}

let mut a = Mat::&lt;f64&gt;::new();
let mut view = a.as_mut();

takes_view_mut(view.rb_mut());
takes_view_mut(view.rb_mut());
takes_view(view.rb()); // We can also reborrow immutably

{
    let short_view = view.rb_mut();

    // This would have failed to compile since we can't use the original view
    // while the reborrowed view is still being actively used
    // takes_view_mut(view);

    takes_view_mut(short_view);
}

// We can once again use the original view
takes_view_mut(view.rb_mut());

// Or consume it to convert it to an immutable view
takes_view(view.into_const());</code></pre>
<h2 id="splitting-a-matrix-view-slicing-a-submatrix"><a class="header" href="#splitting-a-matrix-view-slicing-a-submatrix">Splitting a matrix view, slicing a submatrix</a></h2>
<p>A matrix view can be split up along its row axis, column axis or both.
This is done using <a href="https://docs.rs/faer/latest/faer/mat/struct.MatRef.html#method.split_at_row"><code>MatRef::split_at_row</code></a>, <a href="https://docs.rs/faer/latest/faer/mat/struct.MatRef.html#method.split_at_col"><code>MatRef::split_at_col</code></a> or
<a href="https://docs.rs/faer/latest/faer/mat/struct.MatRef.html#method.split_at"><code>MatRef::split_at</code></a> (or <a href="https://docs.rs/faer/latest/faer/mat/struct.MatMut.html#method.split_at_row_mut"><code>MatMut::split_at_row_mut</code></a>, <a href="https://docs.rs/faer/latest/faer/mat/struct.MatMut.html#method.split_at_col_mut"><code>MatMut::split_at_col_mut</code></a> or
<a href="https://docs.rs/faer/latest/faer/mat/struct.MatMut.html#method.split_at_mut"><code>MatMut::split_at_mut</code></a>).</p>
<p>These functions take the middle index at which the split is performed, and return
the two sides (in top/bottom or left/right order) or the four corners (top
left, top right, bottom left, bottom right)</p>
<p>We can also take a submatrix using <a href="https://docs.rs/faer/latest/faer/mat/struct.MatRef.html#method.subrows"><code>MatRef::subrows</code></a>, <a href="https://docs.rs/faer/latest/faer/mat/struct.MatRef.html#method.subcols"><code>MatRef::subcols</code></a> or
<a href="https://docs.rs/faer/latest/faer/mat/struct.MatRef.html#method.submatrix"><code>MatRef::submatrix</code></a> (or <a href="https://docs.rs/faer/latest/faer/mat/struct.MatMut.html#method.subrows_mut"><code>MatMut::subrows_mut</code></a>, <a href="https://docs.rs/faer/latest/faer/mat/struct.MatMut.html#method.subcols_mut"><code>MatMut::subcols_mut</code></a> or
<a href="https://docs.rs/faer/latest/faer/mat/struct.MatMut.html#method.submatrix_mut"><code>MatMut::submatrix_mut</code></a>).</p>
<p>Alternatively, we can also use <a href="https://docs.rs/faer/latest/faer/mat/struct.MatRef.html#method.get"><code>MatRef::get</code></a> or <a href="https://docs.rs/faer/latest/faer/mat/struct.MatMut.html#method.get_mut"><code>MatMut::get_mut</code></a>, which take
as parameters the row and column ranges.</p>
<h3 id="warning"><a class="header" href="#warning">⚠️Warning⚠️</a></h3>
<p>Note that <a href="https://docs.rs/faer/latest/faer/mat/struct.MatRef.html#method.submatrix"><code>MatRef::submatrix</code></a> (and <a href="https://docs.rs/faer/latest/faer/mat/struct.MatRef.html#method.subrows"><code>MatRef::subrows</code></a>, <a href="https://docs.rs/faer/latest/faer/mat/struct.MatRef.html#method.subcols"><code>MatRef::subcols</code></a>) takes
as a parameter, the first row and column of the submatrix, then the number
of rows and columns of the submatrix.</p>
<p>On the other hand, <a href="https://docs.rs/faer/latest/faer/mat/struct.MatRef.html#method.get"><code>MatRef::get</code></a> takes a range from the first row and column
to the last row and column.</p>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="bench-mt.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>

                            <a rel="next prefetch" href="dense-arithmetic.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="bench-mt.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>

                    <a rel="next prefetch" href="dense-arithmetic.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
            </nav>

        </div>




        <script>
            window.playground_copyable = true;
        </script>


        <script src="elasticlunr.min.js"></script>
        <script src="mark.min.js"></script>
        <script src="searcher.js"></script>

        <script src="clipboard.min.js"></script>
        <script src="highlight.js"></script>
        <script src="book.js"></script>

        <!-- Custom JS scripts -->


    </div>
    </body>
</html>
