---
layout: post
title:  "Benchmarks (f128)"
date:   2023-04-03 00:00:03 +0100
permalink: /bench-f128/
---

The benchmarks were run on an `11th Gen Intel(R) Core(TM) i5-11400 @ 2.60GHz` with 12 threads.  
- `eigen` is compiled with `-march=native -O3 -fopenmp`

All computations are done on column major matrices containing `f128` values, using the `qd` crate.

## Matrix multiplication

Multiplication of two square matrices of dimension `n`.

```
    n       faer  faer(par)    ndarray   nalgebra      eigen
    4      297ns      297ns          -          -      212ns
    8      1.1µs      8.2µs          -          -      1.6µs
   16      3.7µs      8.7µs          -          -     11.6µs
   32     22.9µs     15.7µs          -          -     88.8µs
   64    165.9µs     79.1µs          -          -    183.9µs
   96    553.2µs      204µs          -          -    419.8µs
  128      1.3ms    429.8µs          -          -      2.7ms
  192      4.3ms      1.3ms          -          -      3.3ms
  256     10.2ms      3.4ms          -          -     11.3ms
  384     34.3ms      9.5ms          -          -     26.5ms
  512     83.1ms     22.9ms          -          -     98.4ms
  640    161.1ms     44.6ms          -          -      166ms
  768    283.3ms     73.6ms          -          -    247.1ms
  896    450.8ms    118.1ms          -          -    478.9ms
 1024    687.4ms      182ms          -          -    647.7ms
```

## Triangular solve

Solving `AX = B` in place where `A` and `B` are two square matrices of dimension `n`, and `A`
is a triangular matrix.

```
    n       faer  faer(par)    ndarray   nalgebra      eigen
    4      140ns      137ns          -          -      134ns
    8      1.2µs      1.2µs          -          -      867ns
   16      6.7µs     19.2µs          -          -      6.8µs
   32     29.6µs     86.1µs          -          -     54.4µs
   64    159.1µs    280.9µs          -          -    435.7µs
   96    474.1µs    326.7µs          -          -      1.5ms
  128    986.2µs    590.8µs          -          -      3.5ms
  192        3ms      1.2ms          -          -     11.8ms
  256      6.6ms      2.4ms          -          -       28ms
  384     20.9ms      6.9ms          -          -     94.6ms
  512     47.4ms     15.2ms          -          -      200ms
  640     92.5ms     31.4ms          -          -    390.7ms
  768    155.6ms     49.2ms          -          -    677.6ms
  896    245.2ms     79.8ms          -          -      1.08s
 1024    367.7ms    112.7ms          -          -      1.54s
```

## Triangular inverse

Computing `A^-1` where `A` is a square triangular matrix with dimension `n`.

```
    n       faer  faer(par)    ndarray   nalgebra      eigen
    4      286ns      5.4µs          -          -      134ns
    8      1.3µs      7.9µs          -          -      864ns
   16      5.5µs     20.4µs          -          -      6.8µs
   32     22.6µs     44.1µs          -          -     54.4µs
   64    102.2µs    168.2µs          -          -    435.6µs
   96    298.5µs    376.5µs          -          -      1.5ms
  128      520µs    580.8µs          -          -      3.5ms
  192      1.6ms      1.1ms          -          -     11.8ms
  256        3ms      1.7ms          -          -       28ms
  384      9.4ms      3.8ms          -          -     94.6ms
  512     19.5ms      7.1ms          -          -      200ms
  640     38.7ms     13.8ms          -          -    390.6ms
  768       62ms     19.9ms          -          -    677.6ms
  896     95.2ms     34.2ms          -          -      1.08s
 1024    136.5ms     46.8ms          -          -      1.54s
```

## Cholesky decomposition

Factorizing a square matrix with dimension `n` as `L×L.T`, where `L` is lower triangular.

```
    n       faer  faer(par)    ndarray   nalgebra      eigen
    4      311ns      311ns          -          -      325ns
    8      840ns      840ns          -          -        1µs
   16      3.2µs      3.2µs          -          -      4.6µs
   32       20µs     47.9µs          -          -     26.6µs
   64    107.3µs    247.2µs          -          -    170.3µs
   96    291.1µs    604.2µs          -          -    528.3µs
  128    568.4µs      1.1ms          -          -      1.1ms
  192      1.6ms      2.2ms          -          -      3.6ms
  256      3.2ms      3.4ms          -          -      8.2ms
  384      9.3ms      6.9ms          -          -     26.6ms
  512     20.6ms     11.6ms          -          -     61.8ms
  640     37.7ms     19.8ms          -          -    119.3ms
  768     63.4ms     27.2ms          -          -    204.6ms
  896     97.6ms     45.3ms          -          -      323ms
 1024    142.9ms     60.8ms          -          -    480.6ms
```

## LU decomposition with partial pivoting

Factorizing a square matrix with dimension `n` as `P×L×U`, where `P` is a permutation matrix,
`L` is unit lower triangular and `U` is upper triangular.

```
    n       faer  faer(par)    ndarray   nalgebra      eigen
    4      241ns      242ns          -          -      183ns
    8      620ns      640ns          -          -      725ns
   16      2.2µs      2.3µs          -          -      3.6µs
   32     17.8µs     42.4µs          -          -     37.8µs
   64    112.3µs    223.4µs          -          -      283µs
   96    326.9µs    535.2µs          -          -    937.3µs
  128    699.2µs    961.7µs          -          -      1.4ms
  192      2.1ms        2ms          -          -      3.6ms
  256      4.7ms      3.8ms          -          -      8.9ms
  384     14.7ms      8.4ms          -          -       23ms
  512     33.1ms     17.4ms          -          -     51.2ms
  640       64ms     29.8ms          -          -     91.5ms
  768    107.9ms     44.9ms          -          -    134.4ms
  896    169.4ms     71.2ms          -          -    223.7ms
 1024    251.3ms    103.9ms          -          -    350.7ms
```

## LU decomposition with full pivoting

Factorizing a square matrix with dimension `n` as `P×L×U×Q.T`, where `P` and `Q` are
permutation matrices, `L` is unit lower triangular and `U` is upper triangular.

```
    n       faer  faer(par)    ndarray   nalgebra      eigen
    4      345ns      331ns          -          -      261ns
    8      914ns      921ns          -          -      1.1µs
   16        4µs        4µs          -          -      5.7µs
   32     17.5µs     17.8µs          -          -     61.7µs
   64    101.6µs    101.2µs          -          -    509.9µs
   96    284.3µs    284.7µs          -          -      1.7ms
  128    635.4µs    632.7µs          -          -        4ms
  192        2ms        2ms          -          -     13.1ms
  256      4.7ms      4.7ms          -          -     31.1ms
  384     14.7ms     13.7ms          -          -    103.3ms
  512     35.5ms     21.4ms          -          -    245.1ms
  640     65.3ms     31.7ms          -          -    475.8ms
  768      117ms     47.3ms          -          -    827.2ms
  896    199.7ms     80.4ms          -          -      1.35s
 1024    331.4ms    163.3ms          -          -      2.08s
```

## QR decomposition with no pivoting

Factorizing a square matrix with dimension `n` as `QR`, where `Q` is unitary and `R` is upper
triangular.

```
    n       faer  faer(par)    ndarray   nalgebra      eigen
    4      921ns      920ns          -          -      649ns
    8      3.1µs      3.1µs          -          -      2.2µs
   16     15.5µs     15.4µs          -          -      9.3µs
   32     69.5µs     69.5µs          -          -     51.9µs
   64    335.7µs    334.7µs          -          -      651µs
   96    847.4µs    845.4µs          -          -        2ms
  128      1.7ms      1.7ms          -          -      4.7ms
  192        5ms        5ms          -          -     14.8ms
  256     10.8ms      9.7ms          -          -     34.1ms
  384     33.7ms     22.3ms          -          -    110.2ms
  512       77ms     44.6ms          -          -    255.6ms
  640    140.2ms     74.1ms          -          -    492.3ms
  768    238.5ms      120ms          -          -    843.1ms
  896    374.6ms    179.4ms          -          -      1.33s
 1024    559.4ms      257ms          -          -      1.98s
```

## QR decomposition with column pivoting

Factorizing a square matrix with dimension `n` as `QRP`, where `P` is a permutation matrix,
`Q` is unitary and `R` is upper triangular.

```
    n       faer  faer(par)    ndarray   nalgebra      eigen
    4      1.5µs      1.4µs          -          -      1.2µs
    8      5.1µs      5.2µs          -          -      4.2µs
   16       23µs     22.9µs          -          -     17.2µs
   32    101.3µs    101.3µs          -          -     83.5µs
   64    534.9µs    572.9µs          -          -    479.6µs
   96      1.4ms      1.4ms          -          -      1.4ms
  128      2.8ms      2.8ms          -          -      3.1ms
  192      7.5ms      7.5ms          -          -      9.9ms
  256     15.8ms     11.9ms          -          -     23.5ms
  384     46.3ms     18.3ms          -          -     73.7ms
  512      102ms     29.5ms          -          -      171ms
  640    190.5ms     46.3ms          -          -    327.7ms
  768    321.1ms     70.5ms          -          -    562.8ms
  896    507.2ms    106.6ms          -          -    910.3ms
 1024    762.2ms    181.3ms          -          -       1.4s
```

## Matrix inverse

Computing the inverse of a square matrix with dimension `n`.

```
    n       faer  faer(par)    ndarray   nalgebra      eigen
    4      1.7µs      9.7µs          -          -      620ns
    8      5.6µs     21.1µs          -          -      2.8µs
   16     19.5µs     33.9µs          -          -       18µs
   32     91.3µs    112.2µs          -          -    148.4µs
   64    461.8µs    467.9µs          -          -      1.2ms
   96      1.4ms      1.1ms          -          -      3.9ms
  128      2.5ms        2ms          -          -      8.5ms
  192      7.8ms      4.4ms          -          -     27.4ms
  256     15.8ms      7.5ms          -          -     65.3ms
  384     49.7ms     17.9ms          -          -    213.6ms
  512    108.1ms     36.9ms          -          -    454.1ms
  640    212.3ms     67.2ms          -          -    878.3ms
  768    346.9ms    119.5ms          -          -       1.5s
  896    535.2ms    182.4ms          -          -      2.38s
 1024      783ms    259.4ms          -          -      3.43s
```

## Square matrix singular value decomposition

Computing the SVD of a square matrix with dimension `n`.

```
    n       faer  faer(par)    ndarray   nalgebra      eigen
    4     14.5µs       14µs          -          -     11.4µs
    8     94.4µs    120.9µs          -          -     74.6µs
   16    423.8µs    438.5µs          -          -    546.7µs
   32      1.8ms      1.6ms          -          -      2.8ms
   64      7.3ms      6.7ms          -          -       17ms
   96     17.2ms     14.1ms          -          -     45.6ms
  128     31.9ms     25.1ms          -          -     84.5ms
  192     77.6ms     53.2ms          -          -      208ms
  256    148.7ms       95ms          -          -    399.9ms
  384    388.9ms    215.1ms          -          -      1.04s
  512    788.4ms      403ms          -          -       2.1s
  640      1.37s    657.5ms          -          -      3.63s
  768      2.21s      1.01s          -          -       5.7s
  896      3.33s      1.44s          -          -      8.52s
 1024      4.81s      1.95s          -          -     12.27s
```

## Thin matrix singular value decomposition

Computing the SVD of a rectangular matrix with shape `(4096, n)`.

```
    n       faer  faer(par)    ndarray   nalgebra      eigen
    4    606.8µs    947.8µs          -          -    932.1µs
    8      1.8ms      2.1ms          -          -      3.4ms
   16      5.2ms      5.8ms          -          -      9.4ms
   32     16.9ms       16ms          -          -     35.7ms
   64     59.8ms     48.7ms          -          -      208ms
   96    119.3ms     80.3ms          -          -    467.9ms
  128    208.3ms    134.1ms          -          -    794.5ms
  192    460.3ms    269.9ms          -          -      1.73s
  256    874.6ms    503.8ms          -          -      2.96s
  384      1.79s    889.2ms          -          -      6.35s
  512      3.48s      1.82s          -          -     10.98s
  640      5.16s      2.48s          -          -     16.84s
  768      7.68s      3.67s          -          -     23.88s
  896     10.48s      4.81s          -          -      32.3s
 1024        15s      7.13s          -          -      41.8s
```

## Hermitian matrix eigenvalue decomposition

Computing the EVD of a hermitian matrix with shape `(n, n)`.

```
    n       faer  faer(par)    ndarray   nalgebra      eigen
    4      6.9µs      7.5µs          -          -      5.3µs
    8     31.6µs     32.2µs          -          -     22.7µs
   16    125.8µs    132.1µs          -          -     93.6µs
   32      552µs    554.7µs          -          -    449.5µs
   64      3.2ms      3.5ms          -          -      2.5ms
   96      8.5ms      7.8ms          -          -      7.1ms
  128     15.8ms     13.8ms          -          -     15.4ms
  192     40.4ms     30.3ms          -          -     46.7ms
  256     77.4ms     55.9ms          -          -    104.1ms
  384    203.4ms    122.9ms          -          -    332.1ms
  512    410.1ms      232ms          -          -    759.9ms
  640    710.5ms      372ms          -          -      1.46s
  768      1.14s    552.7ms          -          -      2.52s
  896      1.72s    796.4ms          -          -      4.02s
 1024      2.46s      1.07s          -          -      6.08s
```

## Non Hermitian matrix eigenvalue decomposition

Computing the EVD of a matrix with shape `(n, n)`.

```
    n       faer  faer(par)    ndarray   nalgebra      eigen
    4     17.2µs     16.9µs          -          -     11.5µs
    8    105.8µs    111.6µs          -          -     47.4µs
   16    532.6µs    596.4µs          -          -    200.8µs
   32      2.9ms      3.3ms          -          -      1.4ms
   64     19.7ms       21ms          -          -      9.9ms
   96     35.7ms       45ms          -          -     29.1ms
  128     72.2ms     82.2ms          -          -     67.4ms
  192    230.1ms    200.1ms          -          -    212.2ms
  256    427.6ms    374.9ms          -          -    537.8ms
  384      1.04s    897.3ms          -          -      1.66s
  512      2.15s      1.76s          -          -       4.1s
  640       3.6s      3.08s          -          -       7.7s
  768      5.64s      4.48s          -          -     13.76s
  896      8.11s       6.1s          -          -     21.47s
 1024     11.81s      8.61s          -          -      32.4s
```
